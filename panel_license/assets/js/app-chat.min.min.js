"use strict";document.addEventListener("DOMContentLoaded",function(){(function(){const chatContactsBody=document.querySelector(".app-chat-contacts .sidebar-body"),chatContactListItems=[].slice.call(document.querySelectorAll(".chat-contact-list-item:not(.chat-contact-list-item-title)")),chatHistoryBody=document.querySelector(".chat-history-body"),chatSidebarLeftBody=document.querySelector(".app-chat-sidebar-left .sidebar-body"),chatSidebarRightBody=document.querySelector(".app-chat-sidebar-right .sidebar-body"),chatUserStatus=[].slice.call(document.querySelectorAll(".form-check-input[name='chat-user-status']")),chatSidebarLeftUserAbout=$(".chat-sidebar-left-user-about"),formSendMessage=document.querySelector(".form-send-message"),messageInput=document.querySelector(".message-input"),searchInput=document.querySelector(".chat-search-input"),speechToText=$(".speech-to-text"),userStatusObj={active:"avatar-online",offline:"avatar-offline",away:"avatar-away",busy:"avatar-busy"};if(chatContactsBody){new PerfectScrollbar(chatContactsBody,{wheelPropagation:false,suppressScrollX:true})}if(chatHistoryBody){new PerfectScrollbar(chatHistoryBody,{wheelPropagation:false,suppressScrollX:true})}if(chatSidebarLeftBody){new PerfectScrollbar(chatSidebarLeftBody,{wheelPropagation:false,suppressScrollX:true})}if(chatSidebarRightBody){new PerfectScrollbar(chatSidebarRightBody,{wheelPropagation:false,suppressScrollX:true})}function scrollToBottom(){chatHistoryBody.scrollTo(0,chatHistoryBody.scrollHeight)}scrollToBottom();if(chatSidebarLeftUserAbout.length){chatSidebarLeftUserAbout.maxlength({alwaysShow:true,warningClass:"label label-success bg-success text-white",limitReachedClass:"label label-danger",separator:"/",validate:true,threshold:120})}chatUserStatus.forEach(el=>{el.addEventListener("click",e=>{let chatLeftSidebarUserAvatar=document.querySelector(".chat-sidebar-left-user .avatar"),value=e.currentTarget.value;chatLeftSidebarUserAvatar.removeAttribute("class");Helpers._addClass("avatar avatar-xl w-px-75 h-px-75 "+userStatusObj[value]+"",chatLeftSidebarUserAvatar);let chatContactsUserAvatar=document.querySelector(".app-chat-contacts .avatar");chatContactsUserAvatar.removeAttribute("class");Helpers._addClass("flex-shrink-0 avatar "+userStatusObj[value]+" me-3",chatContactsUserAvatar)})});chatContactListItems.forEach(chatContactListItem=>{chatContactListItem.addEventListener("click",e=>{chatContactListItems.forEach(chatContactListItem=>{chatContactListItem.classList.remove("active")});e.currentTarget.classList.add("active")})});if(searchInput){searchInput.addEventListener("keyup",e=>{let searchValue=e.currentTarget.value.toLowerCase(),searchChatListItemsCount=0,searchContactListItemsCount=0,chatListItem0=document.querySelector(".chat-list-item-0"),contactListItem0=document.querySelector(".contact-list-item-0"),searchChatListItems=[].slice.call(document.querySelectorAll("#chat-list li:not(.chat-contact-list-item-title)")),searchContactListItems=[].slice.call(document.querySelectorAll("#contact-list li:not(.chat-contact-list-item-title)"));searchChatContacts(searchChatListItems,searchChatListItemsCount,searchValue,chatListItem0);searchChatContacts(searchContactListItems,searchContactListItemsCount,searchValue,contactListItem0)})}function searchChatContacts(searchListItems,searchListItemsCount,searchValue,listItem0){searchListItems.forEach(searchListItem=>{let searchListItemText=searchListItem.textContent.toLowerCase();if(searchValue){if(-1<searchListItemText.indexOf(searchValue)){searchListItem.classList.add("d-flex");searchListItem.classList.remove("d-none");searchListItemsCount++}else{searchListItem.classList.add("d-none")}}else{searchListItem.classList.add("d-flex");searchListItem.classList.remove("d-none");searchListItemsCount++}});if(searchListItemsCount==0){listItem0.classList.remove("d-none")}else{listItem0.classList.add("d-none")}}formSendMessage.addEventListener("submit",e=>{e.preventDefault();if(messageInput.value){let renderMsg=document.createElement("div");renderMsg.className="chat-message-text mt-2";renderMsg.innerHTML='<p class="mb-0 text-break">'+messageInput.value+"</p>";document.querySelector("li:last-child .chat-message-wrapper").appendChild(renderMsg);messageInput.value="";scrollToBottom()}});let chatHistoryHeaderMenu=document.querySelector(".chat-history-header [data-target='#app-chat-contacts']"),chatSidebarLeftClose=document.querySelector(".app-chat-sidebar-left .close-sidebar");chatHistoryHeaderMenu.addEventListener("click",e=>{chatSidebarLeftClose.removeAttribute("data-overlay")});if(speechToText.length){var SpeechRecognition=SpeechRecognition||webkitSpeechRecognition;if(SpeechRecognition!==undefined&&SpeechRecognition!==null){var recognition=new SpeechRecognition,listening=false;speechToText.on("click",function(){const $this=$(this);recognition.onspeechstart=function(){listening=true};if(listening===false){recognition.start()}recognition.onerror=function(event){listening=false};recognition.onresult=function(event){$this.closest(".form-send-message").find(".message-input").val(event.results[0][0].transcript)};recognition.onspeechend=function(event){listening=false;recognition.stop()}})}}})()});